\input{../base.tex}
\fancyhead[L]{Übungsblatt 4}
\setcounter{MaxMatrixCols}{20}
\begin{document}
\section*{Aufgabe 17}
Sei $\C$ ein linearer $[n,k]$-Code über dem endlichen Körper $K$ mit Kontrollmatrix $H$.
Sei $y \in K^n \setminus \C$. Zeigen Sie:
\begin{myList}
#
Genau dann existiert ein $c \in \C$ mit $d(c,y)=1$, wenn $Hy^t = a \cdot s$ für ein $a \in K \setminus \lbrace 0 \rbrace$ und eine Spalte $s$ von $H$.\\
Ist dabei $s$ die $i$-te Spalte von $H$, so gilt $d(c,y) = 1$ für $c = y -a\cdot e_i \in \C$, wobei $e_i$ der $i$-te kanonische Basisvektor des $K^n$ ist.
## ''$\implies$'':\\
Sei $y\in K^n\setminus\C$ und $c\in\C$ mit $d(c, y)=1$. Sei $i$ die Stelle von $c$ und $y$, an denen diese unterschiedlich sind. Dann gilt:
$$c = y - a\cdot e_i$$
mit $a = (y_i - c)^{-1}$ (das multiplikative Inverse von $y_i-c$).\\
\begin{align*}
& Hc^t = 0 = Hy^t - H(a\cdot e_i)^t\\
\iff & Hy^t = H(a\cdot e_i)^t = a\cdot He_i^t = a\cdot\text{ die $i$-te Spalte von H}
\end{align*}
## ''$\seilpmi$'':\\
Sei $y\in K^n\setminus\C$ mit $Hy^t = a\cdot s$ für ein $a\in K$ und die $i$-te Spalte $s$ von $H$. Dann gilt:
\begin{align*}
& Hy^t = a\cdot s = a\cdot He_i^t\\
\iff & Hy^t - H(a\cdot e_i^t) = H(y^t - a\cdot e_i^t) = 0
\end{align*}
Das heißt aber, dass es einen Vektor $c'=y^t - a\cdot e_i^t$ gibt, sodass $Hc'=0$, und damit auch ein $c=c'^t$, sodass $Hc^t=0$. Dann muss aber gerade gelten, dass $c\in\C$.

$d(y, c)=1$, da $c$ als Modifikation einer Zeile von $y$ entstanden ist.
#
Die Anzahl der Spalten von $H$, die ein von 0 verschiedenes Vielfaches von $Hy^t$ sind, ist gleich der Anzahl der Codewörter $c$ mit $d(c,y) = 1$.\\\\
Seien $c_1, \ldots, c_m\in\C$ paarweise verschieden mit $d(c_i, y) = 1$ für alle $i=1\ldots m$. Sei $e_i$ der Einheitsvektor aus $K^n$, sodass $c_i=y - a_i\cdot e_i$ für ein $a_i\in K$, und $s_i$ die zu $c_i$ gehörende $i'$-te Spalte aus $H$, sodass $Hy^t=a_i\cdot s_i$.

Angenommen es gibt zwei $s_i, s_j$, sodass $i\not=j$ aber $i'=j'$. Dann ist auch $s_i=s_j, e_i=e_j$ und $a_i=a_j$. Außerdem ist $c_i + a_i\cdot e_i = y = c_j + a_j\cdot e_j$. Dann gilt:
\begin{align*}
&& y = c_i + a_i\cdot e_i &= c_j + a_j\cdot e_j\\
\iff && c_i + a_i\cdot e_i &= c_j + a_i\cdot e_i\\
\iff && c_i &= c_j
\end{align*}
Das ist aber ein Widerspruch zur Vorraussetzung, dass alle $c_i$ paarweise verschieden sind. Also folgt das zu Zeigende.
#
Entwickeln Sie unter Verwendung von a) ein schnelles Decodierverfahren für die Hamming-Codes.\\\\
Da für jeden $[n, k]$-Hammingcode $\C$ mit $l\times n$ Kontrollmatrix $H$ über einem endlichen Körper $K$ gilt, dass $d(\C)=3$, gibt es für jedes $y\in K^n$ ein $c\in\C$, so dass $d(c, y)\leq 1$. Um also schnell zu Decodieren, berechne $b = H\,y^t$. 

Ist $b=0$, so decodiere zu $y$, da $y\in\C$. 

Sonst: Bestimme eine Spalte $s$ aus $H$, sodass $b$ ein Vielfaches von $s$ ist. Für jede Spalte $s'$ lässt sich in Zeit $O(l)$ entscheiden, ob es ein $a$ gibt, sodass $b=a\cdot s'$ ist, da multiplikative Inverse eindeutig sind. Um also eine solche Spalte zu bestimmen, benötigt man insgesamt Zeit $O(n\cdot l)$.

Dann kann man zu $y - a\cdot e_i$ decodieren, mit $s$: $i$-te Spalte von $H$.
\end{myList}
\section*{Aufgabe 18}
Sei $\C = \lbrace (x_1,x_2,x_3,x_4,x_5) \in \Z^5_7 : x_4 = 2x_1 + 4x_3, x_5 = x_1 + 2x_2 + 2x_3 \rbrace$
Bestimmen Sie Erzeuger- und Kontrollmatrizen für $\C$ und $\C^\bot$.\\\\
\begin{equation*}
  H^\bot = G =
  \begin{pmatrix}
  1 & 0 & 0 & 2 & 1 \\
  0 & 1 & 0 & 0 & 2 \\
  0 & 0 & 1 & 4 & 2 
  \end{pmatrix}
\end{equation*}
Dann gilt: 
\begin{align*}
  \tuple{x_1, x_2, x_3} G\\
= \tuple{x_1, x_2, x_3}
  \begin{pmatrix}
  1 & 0 & 0 & 2 & 1 \\
  0 & 1 & 0 & 0 & 2 \\
  0 & 0 & 1 & 4 & 2 
  \end{pmatrix}\\
= \tuple{x_1, x_2, x_3, 2x_1+4x_3, x_1+2x_2+2x_3}
\end{align*}
Da $G$ in Standardform ist, kann $H$ einfach aufgeschrieben werden:
\begin{equation*}
  G^\bot = H = 
  \begin{pmatrix}
  2 & 0 & 4 & 1 & 0 \\
  1 & 2 & 2 & 0 & 1 
  \end{pmatrix}
\end{equation*}
\section*{Aufgabe 19}
Sei $\C$ der $[7,4]$-Code über $\Z_3$ mit Erzeugermatrix
\begin{equation*}
	G =
	\begin{pmatrix}
	2 & 1 & 0 & 1 & 1 & 0 & 0 \\
	2 & 1 & 0 & 2 & 0 & 2 & 0 \\
	0 & 2 & 0 & 2 & 0 & 2 & 1 \\
	0 & 1 & 1 & 1 & 0 & 2 & 0
	\end{pmatrix}
\end{equation*}
\begin{myList}
#
Zeigen Sie, dass $\C$ eine Erzeugermatrix in Standardform besitzt.\\\\
\begin{align*}
G =&  \begin{pmatrix}
  2 & 1 & 0 & 1 & 1 & 0 & 0 \\
  2 & 1 & 0 & 2 & 0 & 2 & 0 \\
  0 & 2 & 0 & 2 & 0 & 2 & 1 \\
  0 & 1 & 1 & 1 & 0 & 2 & 0
  \end{pmatrix} \lgsto{2\,\rom 1}{\rom 2}{2\,\rom 3}{\rom 4} && \begin{pmatrix}
  1 & 2 & 0 & 2 & 2 & 0 & 0 \\
  2 & 1 & 0 & 2 & 0 & 2 & 0 \\
  0 & 1 & 0 & 1 & 0 & 1 & 2 \\
  0 & 1 & 1 & 1 & 0 & 2 & 0
  \end{pmatrix}\\
\lgsto{\rom 1 + \rom 3}{\rom 1 + \rom 2}{\rom 3}{\rom 4}& \begin{pmatrix}
  1 & 0 & 0 & 0 & 2 & 1 & 2 \\
  0 & 0 & 0 & 1 & 2 & 2 & 0 \\
  0 & 1 & 0 & 1 & 0 & 1 & 2 \\
  0 & 1 & 1 & 1 & 0 & 2 & 0
  \end{pmatrix} \lgsto{\rom 1}{\rom 3}{2\,\rom 3 + \rom 4}{\rom 2} && \begin{pmatrix}
  1 & 0 & 0 & 0 & 2 & 1 & 2 \\
  0 & 1 & 0 & 1 & 0 & 1 & 2 \\
  0 & 0 & 1 & 0 & 0 & 1 & 1 \\
  0 & 0 & 0 & 1 & 2 & 2 & 0 
  \end{pmatrix}\\
\lgsto{\rom 1}{\rom 2 + 2\,\rom 4}{\rom 3}{\rom 4}&\begin{pmatrix}
  1 & 0 & 0 & 0 & 2 & 1 & 2 \\
  0 & 1 & 0 & 0 & 1 & 2 & 2 \\
  0 & 0 & 1 & 0 & 0 & 1 & 1 \\
  0 & 0 & 0 & 1 & 2 & 2 & 0 
  \end{pmatrix}\\
\end{align*}
#
Bestimmen Sie eine Erzeugermatrix von $C^\bot$.\\\\
\begin{align*}
G^\bot = H = \begin{pmatrix}
  2 & 1 & 0 & 2 & 1 & 0 & 0 \\
  1 & 2 & 1 & 2 & 0 & 1 & 0 \\
  2 & 2 & 1 & 0 & 0 & 0 & 1
  \end{pmatrix}\\
\end{align*}
#
Bestimmen Sie $C \cap C^\bot$.\\\\
$C \cap C^\bot = \set{\tuple{0, 0, 0, 0, 0, 0, 0}}$ (berechnet mit Haskell: \url{https://goo.gl/EIMQ6I})
\end{myList}
\section*{Aufgabe 20}
\begin{myList}
#
Bestimmen Sie alle selbstdualen Hamming-Codes.
(Hinweis: Nicht nur auf den binären Fall beschränken!)\medskip

Wir wollen diejenigen $\C$ bestimmen für die gilt:
\begin{equation*}
	\C = \C^\bot
\end{equation*}
unter der Voraussetzung dass $\C$ Hamming-Code ist.\medskip

Aus Lemma X folgt dass falls $\C$ ein $[n,k]$ Code ist, dann $\C^\bot$ ein $[n,n-k]$ Code ist. Da wir zeigen wollen dass $\C = \C^\bot$ muss also gelten dass $n$ gerade ist und $k = \frac{n}{2}$.
Im folgenden seien also sowohl $\C$ als auch $\C^\bot$ $[2n, n]$ Codes.\medskip

Aus der Tatsache dass $\C$ Hamming Code ist wissen wir dass:
\begin{itemize}
	\item $d(\C) = 3$
	\item $\C$ ist Untervektorraum von $K^{2n}$, $dim(C) = n = 2n - l$ $\Rightarrow l = n$
	\item $\C \subset K^{2n}$, $|K| = q$, $2n = \frac{q^n - 1}{q -1}$ ($q$ ist Primzahlpotenz)
	\item $\C$ ist perfekt, i.e. $|\C| = \frac{q^{2n}}{\sum_{i=0}^1 \binom{2n}{i}(q -1)^i} =  \frac{q^{2n}}{ 1 + 2n(q -1)}$
\end{itemize}\medskip

In der Gleichung $|\C| = \frac{q^{2n}}{1 + 2n(q-1)}$ können wir $2n$ im Nenner durch $\frac{q^n -1}{q-1}$ ersetzen und erhalten $|\C| = q^n$.\medskip

Sowohl die Erzeugermatrix als auch die Kontrollmatrix von $\C$ muss eine $n \times 2n$-Matrix sein.
Desweiteren muss die Erzeugermatrix von $\C$ immer auch eine Kontrollmatrix von $\C$ sein.
Das folgt aus Lemma X welches behauptet dass die Erzeugermatrix von $\C$ eine Kontrollmatrix von $\C^\bot = \C$ ist. 
Aus dem selben Grund muss Ausserdem jede Kontrollmatrix von $\C$ eine Erzeugermatrix von $\C^\bot = \C$ sein.\medskip

Wir haben bisher also gezeigt dass falls $\C$ ein Hamming-Code ist und falls $\C = \C^\bot$, dann muss $\C$ ein $[2n,n]$ Code sein, und die Erzeugermatrix von $\C$ muss auch eine Kontrollmatrix von $\C$ sein. Ausserdem muss $|\C| = q^n$ sein.\medskip

Aus $|\C| = q^n$ und der Tatsache dass die Erzeugermatrix von $\C$ eine $n \times 2n$ Matrix ist folgt aus Kardinalitätsgründen auch dass alle Zeilen der Erzeuger/Kontrollmatrix linear unabhängig sein müssen.

#
Konstruieren Sie für jede gerade natürliche Zahl $n$ einen selbstdualen binären linearen Code der Länge $n$.\medskip

Behauptung: für jede natürliche Zahl $n$ erzeugt die folgende Erzeugermatrix einen selbstdualen binären linearen Code der Länge n:
\begin{equation*}
	G = (I_{n/2} | I_{n/2})
\end{equation*}
Am Beispiel von $n = 12$ sieht $G$ also folgendermaßen aus:
\begin{equation*}
	G = 
	\begin{pmatrix}
	1 & 0 & 0 & 0 & 0 & 0 		& 1 & 0 & 0 & 0 & 0 & 0\\
	0 & 1 & 0 & 0 & 0 & 0 		& 0 & 1 & 0 & 0 & 0 & 0\\
	0 & 0 & 1 & 0 & 0 & 0 		& 0 & 0 & 1 & 0 & 0 & 0\\
	0 & 0 & 0 & 1 & 0 & 0 		& 0 & 0 & 0 & 1 & 0 & 0\\
	0 & 0 & 0 & 0 & 1 & 0 		& 0 & 0 & 0 & 0 & 1 & 0\\
	0 & 0 & 0 & 0 & 0 & 1 		& 0 & 0 & 0 & 0 & 0 & 1
	\end{pmatrix}
\end{equation*}
Wird zB das Infowort $i =(1,0,0,1,0,1)$ codiert so erhält man das Codewort $c = i \cdot G = (1,0,0,1,0,1,1,0,0,1,0,1)$. Und da $G$ auch Kontrollmatrix für $\C$ ist gilt $G \cdot (1,0,0,1,0,1,1,0,0,1,0,1)^t = 0$.\medskip

Allgemein ist zu zeigen dass: $c \in \C \Leftrightarrow c \in \C^\bot$.
Das gilt nach Lemma X, d) da G in Standardform ist und $G = (I_k|A) = (-A^t|I_k)$ für das angegebene $G$ trivialerweise erfüllt ist, $G$ also auch eine Erzeugermatrix des dualen Codes ist.
\end{myList}
\section*{Aufgabe 21}
Sei $\C$ der binäre $[15,4]$-Simplex Code mit Erzeugermatrix
\begin{equation*}
	G = 
	\begin{pmatrix}
	1 & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 \\
	1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 & 1 & 0 & 1 & 0 & 0 \\
	0 & 1 & 1 & 0 & 1 & 0 & 1 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 0 \\
	0 & 0 & 1 & 1 & 0 & 1 & 1 & 1 & 1 & 0 & 1 & 0 & 0 & 0 & 1
	\end{pmatrix}
\end{equation*}
\begin{myList}
#
Zeigen Sie, dass $\C$ 3-Fehler-korrigierend ist.

Da $\C$ Simplex-Code ist gilt dass für alle Codewörter $c\neq c'$ in $\C$ der Abstand konstant ist. Insbesondere gilt daher $d(\C) = wt(c)$ für ein beliebiges Codewort $c \neq 0 \in \C$.\medskip

Aus der Erzeugermatrix kann daher direkt abgelesen werden dass $d(\C) = 8$.
Daraus folgt direkt dass das maximale $t$ mit $2t+1 \leq d(\C) = 8$ genau 3 ist.
#
Bei der Übertragung eines Codeworts aus $\C$ seien maximal 3 Fehler aufgetreten. Das empfangene Wort sei:
\begin{equation*}
	z = (0,1,1,1,1,0,0,0,0,0,1,1,1,1,1)
\end{equation*}
Entscheiden Sie mittels (einstufiger) Majority-Logic-Decodierung, ob an Position 4 ein Fehler aufgetreten ist.\medskip

Da maximal 3 Fehler aufgetreten sind müssen wir 6 Vektoren aus $\C^\bot$ finden die orthogonal bezüglich der 4ten Position sind.\medskip

Es gilt in Variation des Beweises von Lemma X:\\
$(A |I_k)$ Erzeugermatrix von $\C \Rightarrow$ $(I_{n-k}|-A^t)$ Erzeugermatrix von $\C^\bot$.
Beweis:
\begin{equation*}
	(I_{n-k}|-A^t) (A|I_k)^t = (I_{n-k}|-A^t)\left(\frac{A^t}{I_k}\right) = I_{n+k}A^t - A^tI_k = 0
\end{equation*}\medskip

Also ist die folgende Matrix Erzeugermatrix von $C^\bot$:
\begin{equation*}
	\begin{pmatrix}
	1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 &		1 & 1 & 0 & 0 \\
	0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 &		0 & 1 & 1 & 0 \\
	0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 &		0 & 0 & 1 & 1 \\
	0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 &		1 & 0 & 0 & 1 \\
	0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 &		1 & 0 & 1 & 0 \\
	0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 &		0 & 1 & 0 & 1 \\
	0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 &		0 & 1 & 1 & 1 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 &		1 & 0 & 1 & 1 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 &		1 & 1 & 0 & 1 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 &		1 & 1 & 1 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 &		1 & 1 & 1 & 1 
	\end{pmatrix}
\end{equation*}
Die Zeilen seien als $z_0$ bis $z_{10}$ bezeichnet, wir geben jetzt $v_0$ bis $v_5$ aus $\C^\bot$ an die orthogonal bzgl. der vierten Position sind:\\
\begin{align*}
	v_0 &= z_3 &= \begin{pmatrix}
		0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 &		1 & 0 & 0 & 1
		\end{pmatrix} \\
	v_1 &= z_3 + z_7 &= \begin{pmatrix}
		0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 &		0 & 0 & 1 & 0
		\end{pmatrix}\\
	v_2 &= z_3 + z_8 &= \begin{pmatrix}
		0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 0 &		0 & 1 & 0 & 0
		\end{pmatrix}\\
	v_3 &= z_3 + z_1 + z_{10} &= \begin{pmatrix}
		0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 1 &		0 & 0 & 0 & 0
		\end{pmatrix}\\
	v_4 &= z_3 + z_2 + z_4 &= \begin{pmatrix}
		0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 &		0 & 0 & 0 & 0
		\end{pmatrix}\\
	v_5 &= z_3 + z_0 + z_5 &= \begin{pmatrix}
		1 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 &		0 & 0 & 0 & 0
		\end{pmatrix}
\end{align*}

An Stelle 4 ist in $z$ ein Fehler aufgetreten $\Leftrightarrow |\lbrace j: <v_j,z> = 1\rbrace| > |\lbrace j:<v_j,z> = 0 \rbrace|$
\begin{align*}
	<v_0,z> &= 1 \\
	<v_1,z> &= 0 \\
	<v_2,z> &= 0 \\
	<v_3,z> &= 1 \\
	<v_4,z> &= 1 \\
	<v_5,z> &= 1 
\end{align*}
Es ist also ein Fehler an Position 4 aufgetreten.
\end{myList}
\end{document}
